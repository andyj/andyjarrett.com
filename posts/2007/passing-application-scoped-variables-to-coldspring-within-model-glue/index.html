<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="description" content="Andy Jarrett online pressence">
<meta name="keywords" content="Andy Jarrett, andyjarrett, mytag">
<meta name="author" content="Andy Jarrett">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Passing Application scoped variables to ColdSpring within Model Glue</title>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Passing Application scoped variables to ColdSpring within Model Glue">
<meta name="twitter:description" content="Go to AndyJarrett.com for more">
<meta name="twitter:creator" content="@andyj" />
<meta property="og:title" content="Passing Application scoped variables to ColdSpring within Model Glue">
<meta property="og:description" content="Go to AndyJarrett.com for more">
<meta property="og:image" content="https://www.andyjarrett.com/public/img/hero.og.image">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://www.andyjarrett.com/posts/2007/passing-application-scoped-variables-to-coldspring-within-model-glue/">
<link rel="icon" href="/public/img/AJ_ICON.png" type="image/x-icon">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://andyjarrett.com/feed.xml"/>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://feeds.feedburner.com/andyj"/>
<link rel="sitemap" href="https://andyjarrett.com/sitemap.xml" type="application/xml" />
<link rel="stylesheet" href="https://bootswatch.com/5/materia/bootstrap.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="/public/css/style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@3.0.1/dist/cookieconsent.css">
<link rel="stylesheet" href="/public/prismjs/prism.css">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L0V74G0Q65"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L0V74G0Q65');
</script>
</head>
<body>
  <div class="container border-bottom pb-2">
  <header class="d-flex flex-wrap justify-content-center">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
      <span class="fs-2">Andy Jarrett // <span class="lead">Code. Develop. Create.</span></span>
    </a>
    <ul class="nav nav-pills">
      <li class="nav-item  p-2">
        <a href="/" class="btn btn-outline-primary rounded-circle p-3 lh-1">
          <i class="bi bi-house fs-5"></i>
          <span class="visually-hidden">Dismiss</span>
        </a>
      </li>
      <li class="nav-item  p-2">
        <a href="/feed.xml" class="btn btn-outline-primary rounded-circle p-3 lh-1">
          <i class="bi bi-rss fs-5"></i>
        </a>
      </li>
      <li class="nav-item  p-2">
        <a href="/linktree" class="btn btn-outline-primary rounded-circle p-3 lh-1" title="Linktree for Andy Jarrett">
          <i class="bi bi-tree fs-5"></i>
        </a>
      </li>
      <li class="nav-item  p-2">
        <a href="https://buymeacoffee.com/mailgw" class="btn btn-outline-primary rounded-circle p-3 lh-1">
          <i class="bi bi-cup-hot-fill fs-5"></i>
        </a>
      </li>
    </ul>
  </header>
</div>  


  <div class="container">
    <div class="my-1 text-center text-info" role="alert">You can now comment! Read about it <a href="/posts/2024/comments-via-giscus-now-live-on-my-blog/">here</a> or leave a <a href="#comment">comment below</a>.</div>
    <h1 class="mt-5 mb-5"><b>Passing Application scoped variables to ColdSpring within Model Glue</b></h1>
    <main class="mw fw-lighter fs-5">
      
Passing defaultProperties in ColdSpring with Model GlueOr Using defaultProperties with CS and MG. I couldn't figure out which title would be better.Basically this is a guide on how to pass variables into ColdSpring. In my case from the Application scope. Recently I've been working on a Model Glue, Transfer, and ColdSpring app and came across a problem which I couldn't find a direct answer to online. The application I'm working is only a small part of the site and has some settings in the Application scope which needs to remain there. Usually I put all my variables in a ColdSpring/Model Glue simpleConfig Bean (using the class ModelGlue.Bean.CommonBeans.SimpleConfig) but this time I needed CS to get the variables from the application scope. This actually isn't too hard as you can pass properties(dynamic variables) into the config.xml e.g.Here's the code for creating the bean factory. You would find this in onApplicationStart or at the top of your Application.cfm.<em>Code for Application.cfm/cfc</em><code><!-- First we create our global vars in the Application scope --><cfset application.settings = structNew() /> <!-- Add our DSN name to the Settings struct --><cfset application.settings.dsn = "myDSN" /><!-- If our bean factory doesn't exist then we create it. You could also check for a url.reinit var as well here --><cfif NOT isDefined("application.beanFactory")> <!-- Our struct to hold the variables we are going to pass to ColdSpring -->  <cfset properties = structNew() />  <!-- Our struct to hold the variables we are going to pass to ColdSpring -->  <cfset properties.dsn = "dsn_reference">  <!-- Create our bean object -->   <cfset application.beanFactory = createObject("component","coldspring.beans.DefaultXmlBeanFactory").init(structNew(), properties)/>   <!-- Pass a fully qualified path to a bean definition xml file -->    <cfset application.beanFactory.loadBeansFromXmlFile(expandPath('/config/beans.xml'), true)/>   </cfif></code>In our Beans.xml we need to reference the properties structure by the key. <em>Code for Beans.xml</em><code><?xml version="1.0" encoding="utf-8"?><beans>   <bean id="myDAO" class="com.myDAO">    <!-- ${dsn} comes from the properties struct we passed in from the Application.cfc/cfm code -->      <constructor-arg name="dsn"><value>${dsn}</value></constructor-arg>   </bean></beans></code></more>Now that we have our beans.xml reading dynamic variable how can we pass this to the default ColdSpring.xml that Model Glue uses?First off when it comes to Model Glue there is already ColdSpring.xml which holds all the config imformation for the application, ORM etc etc. We're not going to touch that so this method is something you can introduce midway through a project. What we are going to do is introduce Beans.xml as the Parent Bean Factory to the child ColdSpring.xml.Create a SimpleConfig bean from Model Glue (ModelGlue.Bean.CommonBeans.SimpleConfig) and save this in the Beans.xml file. This config bean will hold details for our email server. The values are going to come from the Application scope.You xml file should look like:<code><beans>  <!-- Put definitions for your own beans and services here using ModelGlue.Bean.CommonBeans.SimpleConfig class --> <bean id="EmailConfig" class="ModelGlue.Bean.CommonBeans.SimpleConfig">   <property name="config">      <map>       <entry key="emailServer">         <value>${emailServer}</value>       </entry>          <entry key="emailUName">            <value>${emailUName}</value>        </entry>        <entry key="emailPWord">          <value>${emailPWord}</value>        </entry>      </map>    </property>     </bean></beans></code>In the Appliacation.cfm add the following code<code><!-- If our bean factory doesn't exist then we create it. You could also check for a url.reinit var as well here --><cfif NOT isDefined("application.beanFactory")>  <cfset application.emailServer  ="" />  <cfset application.emailUName ="" />  <cfset application.emailPWord ="" />  <!--    Put the email settings into the properties structure which    get passed to a Parent ColdSpring Factory --> <cfset properties = structNew() />  <cfset properties.emailServer = application.emailServer />  <cfset properties.emailUName = application.emailUName />  <cfset properties.emailPWord = application.emailPWord />  <cfset application.beanFactory2 = createObject("component","coldspring.beans.DefaultXmlBeanFactory").init(defaultProperties=properties)/>     <cfset application.beanFactory2.loadBeansFromXmlFile("#expandPath('/config/beans.xml')#",true)/></cfif></code>At this point we have our bean factory stored in application.beanFactory2. We are going to reference this in the index.cfm of MG under the HIERARCHIAL BEAN FACTORY SUPPORT area. Look for the commented out &lt;cfset> which sets the variable ModelGlue_PARENT_BEAN_FACTORY. Uncomment the &lt;cfset> and add the following:<code><!--                                                              **HIERARCHIAL BEAN FACTORY SUPPORT**                                                                                                If you'd like to designate a parent bean factory for the one that powers Model-Glue, simply do whatever you need to do to set the following value to the parent bean factory   instance:                                                     -->                                                           <cfset ModelGlue_PARENT_BEAN_FACTORY = application.beanFactory2 /></code>At this point the hard work is done. All that is left is to add a bean that uses the config setting. In my case I have a CFC in a Model folder which accepts the constructor argument "EmailConfig" e.g.<code><bean id="email" class="model.emailCFC"> <constructor-arg name="EmailConfig">    <ref bean="EmailConfig" />  </constructor-arg></bean> </code>         Thats it. From your emailCFC you just need to reference variables.emailConfig.getconfigSetting('emailServer') to the get the server etc.This post couldn't of been done without the help of <a href="http://www.danvega.org/blog/index.cfm/2006/11/25/Passing-Properties-To-ColdSpring">http://www.danvega.org/blog/index.cfm/2006/11/25/Passing-Properties-To-ColdSpring</a> and <a href="http://groups.google.com/group/model-glue/browse_thread/thread/de628a4fb85c6ebd/">http://groups.google.com/group/model-glue/browse_thread/thread/de628a4fb85c6ebd/</a> so for futher investigation you can start there.<br>
    </main>
    <div class="row">
      <div class="col">
        <script
          src="https://giscus.app/client.js"
          data-repo="andyj/andyjarrett.com"
          data-repo-id="R_kgDOMjCDkQ"
          data-category="Announcements"
          data-category-id="DIC_kwDOMjCDkc4ChlfU"
          data-mapping="pathname"
          data-strict="0"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="top"
          data-theme="preferred_color_scheme"
          data-lang="en"
          crossorigin="anonymous"
          async></script>
        <a name="comment"></a>
      </div>
    </div>
    <div class="row mt-5 ">
      <div class="col-6">
        <strong>Recent Posts</strong>
        <ul>
        
          <li ><a href="/posts/2024/adding-local-storage-for-faster-development-to-the-alpinejs-rss-reader/" class="card-link link-underline-light">Adding localStorage to the Alpine.js RSS Reader</a></li>
        
          <li ><a href="/posts/2024/creating-an-alpinejs-rss-reader-using-bluesky-profiles/" class="card-link link-underline-light">Creating an Alpine.js RSS Reader with my Bluesky Profile feed</a></li>
        
          <li ><a href="/posts/2024/comments-via-giscus-now-live-on-my-blog/" class="card-link link-underline-light">Comments Via Giscus Now Live My Blog</a></li>
        
          <li ><a href="/posts/2024/utility-console-methods-for-debugging-workflow/" class="card-link link-underline-light">Utility Console Methods For Debugging Your Javascript Workflow</a></li>
        
        </ul>
      </div>
      <div class="col-6 pt-3 text-end">
        <em>I’m here, learning and working away. If you liked this content and want to keep me going, consider <a href="https://buymeacoffee.com/mailgw" title="Buy me a coffee!">buying me a coffee</a>. Your support keeps this site running and the coffee brewing! ☕️</em>
      </div>
    </div>
  </div>
  <footer class="container mt-5 border-top pt-2">
  <div class="row justify-content-md-center">
    <div class="col">
      ©AndyJarrett
      <a href="/linktree" title="Linktree for AndyJarrett" target="_blank"><i class="bi bi-tree"></i></a>
      <a href="/sitemap.xml" title="Site map for AndyJarrett.com" target="_blank"><i class="bi bi-map"></i></a>
      <!-- Home Link -->
      <a href="https://andyjarrett.com" class=""><i class="bi bi-globe me-2"></i></a>
      <!-- linkedin Link -->
      <a href="https://www.linkedin.com/in/andyjarrett/" title="inkedIn" target="_blank"><i class="bi bi-linkedin me-2"></i></a>
      <!-- Twitter Link -->
      <a href="https://twitter.com/andyj" title="Twitter" target="_blank"><i class="bi bi-twitter me-2"></i></a>
      <!-- GitHub Link -->
      <a href="https://github.com/andyj" title="GitHub" target="_blank"><i class="bi bi-github me-2"></i></a>
      <!-- Stack Overflow Link -->
      <a href="https://stackoverflow.com/users/371761/andy-jarrett" title="Stack overflow" target="_blank"><i class="bi bi-stack-overflow me-2"></i></a>
      <!-- BlueSky Link -->
      <a href="https://bsky.app/profile/andyjarrett.com" title="BlueSky" target="_blank"><i class="bi bi-cloud me-2"></i></a>
      <!-- Instagram Link -->
      <a href="https://instagram.com/andyjarrett" title="Instragram" target="_blank"><i class="bi bi-instagram me-2"></i></a>
      <a href="https://buymeacoffee.com/mailgw" title="Buy me a coffee" target="_blank"><i class="bi bi-cup-hot-fill fs-5"></i></a>
    </div>
    <div class="col">
      <div class="text-end">
        <div class="btn-group">
          <a href="#" class="btn btn-secondary btn-sm" id="lightThemeButton" data-bs-theme-value="light">
            <i class="bi bi-sun"></i>
          </a>
          <a href="#" class="btn btn-secondary btn-sm" id="darkThemeButton" data-bs-theme-value="dark">
            <i class="bi bi-moon-stars-fill"></i>
          </a>
          <a href="#" class="btn btn-secondary btn-sm" id="autoThemeButton" data-bs-theme-value="auto">
            <i class="bi bi-circle-half"></i>
          </a>
        </div>
      </div>

    </div>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
<script src="/public/js/toggle.js" type="text/javascript"></script>
<script src="/public/prismjs/prism.js"></script>
</body>
</html>