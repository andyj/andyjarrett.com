
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="description" content="Andy Jarrett online pressence">
<meta name="keywords" content="Andy Jarrett, andyjarrett, mytag">
<meta name="author" content="Andy Jarrett">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gmail Contacts Data API access with ColdFusion</title>
<link rel="canonical" href="https://andyjarrett.com">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Gmail Contacts Data API access with ColdFusion">
<meta name="twitter:description" content="Go to AndyJarrett.com for more">
<meta name="twitter:creator" content="@andyj" />
<meta property="og:title" content="Gmail Contacts Data API access with ColdFusion">
<meta property="og:description" content="Go to AndyJarrett.com for more">
<meta property="og:image" content="https://www.andyjarrett.com/public/img/hero.og.image">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="icon" href="/public/img/AJ_ICON.png" type="image/x-icon">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://andyjarrett.com/feed.xml"/>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://feeds.feedburner.com/andyj"/>
<link rel="sitemap" href="https://andyjarrett.com/sitemap.xml" type="application/xml" />
<link rel="stylesheet" href="https://bootswatch.com/5/materia/bootstrap.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="/public/css/style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@3.0.1/dist/cookieconsent.css">
<link rel="stylesheet" href="/public/prismjs/prism.css">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L0V74G0Q65"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L0V74G0Q65');
</script>

</head>
<body>
  <div class="container border-bottom pb-2">
  <header class="d-flex flex-wrap justify-content-center">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
      <span class="fs-2">Andy Jarrett // <span class="lead">Code. Develop. Create.</span></span>
    </a>
    <ul class="nav nav-pills">
      <li class="nav-item  p-2">
        <a href="/" class="btn btn-outline-primary rounded-circle p-3 lh-1">
          <i class="bi bi-house fs-5"></i>
          <span class="visually-hidden">Dismiss</span>
        </a>
      </li>
      <li class="nav-item  p-2">
        <a href="/feed.xml" class="btn btn-outline-primary rounded-circle p-3 lh-1">
          <i class="bi bi-rss fs-5"></i>
        </a>
      </li>
      <li class="nav-item  p-2">
        <a href="/linktree" class="btn btn-outline-primary rounded-circle p-3 lh-1" title="Linktree for Andy Jarrett">
          <i class="bi bi-tree fs-5"></i>
        </a>
      </li>
      <li class="nav-item  p-2">
        <a href="https://buymeacoffee.com/mailgw" class="btn btn-outline-primary rounded-circle p-3 lh-1">
          <i class="bi bi-cup-hot-fill fs-5"></i>
        </a>
      </li>
    </ul>
  </header>
</div>  


  <div class="container">
    <h1 class="mt-5 mb-5"><b>Gmail Contacts Data API access with ColdFusion</b></h1>
    <main class="mw fw-lighter fs-5">
      
I've been looking at accessing the Gmail contact data via their API. This is the first draft of my findings and is no way the finished solution but it does what it says on the tin and returns the email address's from a users Gmail account contacts. Its actually quite simple to and we're going to do this in 2 CFM pages.We are going to be using the AuthSub method of registration<blockquote>There are three levels of registration:<ol>  <li> <strong>Unregistered</strong>: Application is not recognized by Google. The Access Request page, which prompts your users to either grant or deny access for your application, displays this caution highlighted in yellow: "Non-registered, not secure. This website has not registered with Google. We recommend that you continue the process only if you trust this destination."</li> <li><strong>Registered</strong>: Application is recognized by Google. The Access Request page displays this caution: "Registered, not secure. This website is registered with Google to make authorization requests, but has not been configured to send requests securely. We recommend you continue if you trust this destination."</li>  <li><strong>Registered with enhanced security</strong>: Registered applications with a security certificate on file can use secure tokens. The Access Request page displays this message: "Registered, secure. This website is registered with Google to make authorization requests."</li></ol></blockquote><p>As we are going to be using the first method of <strong>Unregistered</strong> the user will getting some simple/basic prompts:</p><ol><li>The first will be asking them to log in and letting them know that "A third party service is requesting permission to access your Google Account"</li><li>Second an Access Request page which lets the user know WHAT we are doing</li></ol> <p>Once they have logged in and agreed Google will take you back to your site. The</p><p>I've put the <em>index.cfm</em> in a folder on the root called <em>contacts</em>. Below is the content for <em>index.cfm</em> read the comments for what each variable is doing. This is all taken from <a href="http://code.google.com/apis/contacts/developers_guide_protocol.html#auth_sub">Googles API docs on AuthSub proxy authentication</a>.</p><code><cfhttp url="https://www.google.com/accounts/AuthSubRequest" method="get" result="res">  <!--- Indicates that the application is requesting a token to access contacts feeds.        The scope string to use is http://www.google.com/m8/feeds/ (URL-encoded, of course). ---> <cfhttpparam name="scope" value="http://www.google.com/m8/feeds/" type="url" /> <!--- Indicates whether the token returned can be exchanged for a multi-use (session) token. ---> <cfhttpparam name="session" value="1" type="url" /> <!--- Indicates whether the client is requesting a secure token. ---> <cfhttpparam name="secure" value="0" type="url" />  <!--- The URL of the page that Google should redirect the user to after authentication. --->  <cfhttpparam name="next" value="http://localhost/contacts/getAddresses.cfm" type="url" /></cfhttp><cfoutput>#res.filecontent#</cfoutput>  </code> <p>Our second page is <em>getAddresses.cfm</em> In the <em>contacts folder</em> <code>  <cfhttp url="http://www.google.com/m8/feeds/contacts/default/base" method="get">  <cfhttpparam type="header" name="Authorization" value="AuthSub token=#url.token#">  <!--- The maximum number of entries to return. If you want to receive all of the    contacts, rather than only the default maximum, you can specify a very large number   for max-results i.e. 9999 --->  <cfhttpparam type="url" name="max-results" value="25" /> </cfhttp><!--- Dump the results---><cfdump var="#cfhttp.fileContent#"></code><p>In my example I am only returning 25 records (for speed mainly) but if you want to know more about returning records check out <a href="http://code.google.com/apis/contacts/developers_guide_protocol.html#retrieving_with_query">Google API docs on query params</a>. Also in my example I just dump the records. If you want to get out the email addresses you can use the following snippet.</p><code><cfset myXmlDoc = xmlParse(cfhttp.fileContent)><cfoutput> <cfloop from="1" to="#arrayLen(myxmldoc['feed']['entry'])#" index="i">  #myxmldoc['feed']['entry'][i]['gd:email'].xmlAttributes.address#<br/> </cfloop></cfoutput>  </code><p>There is still some work to do here but this is the bare bones and a starting point for anyone interested.</p><ul>  <li><a href="http://code.google.com/apis/contacts/developers_guide_protocol.html">Developer's Guide: Protocol</a></li> <li><a href="http://code.google.com/apis/contacts/reference.html">Reference Guide</a></li></ul><br>
    </main>

    <div class="row">
      <div class="col">
        <script src="https://giscus.app/client.js"
                data-repo="andyj/andyjarrett.com"
                data-repo-id="R_kgDOMjCDkQ"
                data-category="Announcements"
                data-category-id="DIC_kwDOMjCDkc4ChlfU"
                data-mapping="pathname"
                data-strict="0"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="top"
                data-theme="preferred_color_scheme"
                data-lang="en"
                crossorigin="anonymous"
                async>
        </script>
      </div>
    </div>

    <div class="row mt-5 ">
      <div class="col-6">
        <strong>Recent Posts</strong>
        <ul>
        
          <li ><a href="/posts/2024/utility-console-methods-for-debugging-workflow/" class="card-link link-underline-light">Utility Console Methods For Debugging Your Javascript Workflow</a></li>
        
          <li ><a href="/posts/2024/advanced-javascript-console-methods/" class="card-link link-underline-light">Advanced Javascript Console Techniques Every Developer Should Be Aware Off</a></li>
        
          <li ><a href="/posts/2024/basic-javascript-console-logging-methods/" class="card-link link-underline-light">Basic Javascript Console Logging Techniques Every Developer Should Know</a></li>
        
          <li ><a href="/posts/2024/reduce-clutter-and-confusion-by-finally-deleting-those-old-branches-local-and-remote/" class="card-link link-underline-light">Reduce clutter and confusion by finally deleting those old branches, local and remote.</a></li>
        
        </ul>
      </div>
      <div class="col-6 pt-3 text-end">
        <em>I’m here, learning and working away. If you liked this content and want to keep me going, consider <a href="https://buymeacoffee.com/mailgw" title="Buy me a coffee!">buying me a coffee</a>. Your support keeps this site running and the coffee brewing! ☕️</em>
      </div>
    </div>
  </div>
  <footer class="container mt-5 border-top pt-2">
  <div class="row justify-content-md-center">
    <div class="col">
      ©AndyJarrett
      <a href="/linktree" title="Linktree for AndyJarrett" target="_blank"><i class="bi bi-tree"></i></a>
      <a href="/sitemap.xml" title="Site map for AndyJarrett.com" target="_blank"><i class="bi bi-map"></i></a>
      <!-- Home Link -->
      <a href="https://andyjarrett.com" class=""><i class="bi bi-globe me-2"></i></a>
      <!-- linkedin Link -->
      <a href="https://www.linkedin.com/in/andyjarrett/" title="inkedIn" target="_blank"><i class="bi bi-linkedin me-2"></i></a>
      <!-- Twitter Link -->
      <a href="https://twitter.com/andyj" title="Twitter" target="_blank"><i class="bi bi-twitter me-2"></i></a>
      <!-- GitHub Link -->
      <a href="https://github.com/andyj" title="GitHub" target="_blank"><i class="bi bi-github me-2"></i></a>
      <!-- Stack Overflow Link -->
      <a href="https://stackoverflow.com/users/371761/andy-jarrett" title="Stack overflow" target="_blank"><i class="bi bi-stack-overflow me-2"></i></a>
      <!-- BlueSky Link -->
      <a href="https://bsky.app/profile/andyjarrett.com" title="BlueSky" target="_blank"><i class="bi bi-cloud me-2"></i></a>
      <!-- Instagram Link -->
      <a href="https://instagram.com/andyjarrett" title="Instragram" target="_blank"><i class="bi bi-instagram me-2"></i></a>
      <a href="https://buymeacoffee.com/mailgw" title="Buy me a coffee" target="_blank"><i class="bi bi-cup-hot-fill fs-5"></i></a>
    </div>
    <div class="col">
      <div class="text-end">
        <div class="btn-group">
          <a href="#" class="btn btn-secondary btn-sm" id="lightThemeButton" data-bs-theme-value="light">
            <i class="bi bi-sun"></i>
          </a>
          <a href="#" class="btn btn-secondary btn-sm" id="darkThemeButton" data-bs-theme-value="dark">
            <i class="bi bi-moon-stars-fill"></i>
          </a>
          <a href="#" class="btn btn-secondary btn-sm" id="autoThemeButton" data-bs-theme-value="auto">
            <i class="bi bi-circle-half"></i>
          </a>
        </div>
      </div>

    </div>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
<script src="/public/js/toggle.js" type="text/javascript"></script>
<script src="/public/prismjs/prism.js"></script>
</body>
</html>





<!-- <div class="card m-2" style="width: 15rem;">
            <div class="card-body">
              <h5 class="card-title">

              </h5>
            </div>
            <div class="card-footer text-end">
              <a href="" class="card-link link-underline-light"></a>
            </div>
          </div> -->